

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Testing code &#8212; Quality Assurance of Code for Analysis and Research</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/markdown_within_tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/accessibility.css" />
    <link rel="stylesheet" type="text/css" href="_static/logo.css" />
    <link rel="stylesheet" type="text/css" href="_static/admonitions.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/tabs.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'testing_code';</script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Automating code quality assurance" href="continuous_integration.html" />
    <link rel="prev" title="Peer review" href="peer_review.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/duck_book_logo.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/duck_book_logo.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary of terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="managers_guide.html">Managing analytical code development</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="checklists.html">Code quality assurance checklists</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="checklist_lower.html">Lower quality assurance</a></li>
<li class="toctree-l2"><a class="reference internal" href="checklist_moderate.html">Moderate quality assurance</a></li>
<li class="toctree-l2"><a class="reference internal" href="checklist_higher.html">Higher quality assurance</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Guidance</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="principles.html">Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="modular_code.html">Modular code</a></li>
<li class="toctree-l1"><a class="reference internal" href="readable_code.html">Readable code</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_structure.html">Structuring your project</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_documentation.html">Code documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_documentation.html">Project documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="version_control.html">Version control</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data management</a></li>
<li class="toctree-l1"><a class="reference internal" href="peer_review.html">Peer review</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Testing code</a></li>
<li class="toctree-l1"><a class="reference internal" href="continuous_integration.html">Automating code quality assurance</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="learning.html">Learning resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/best-practice-and-impact/qa-of-code-guidance" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/best-practice-and-impact/qa-of-code-guidance/edit/master/book/testing_code.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/best-practice-and-impact/qa-of-code-guidance/issues/new?title=Issue%20on%20page%20%2Ftesting_code.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/testing_code.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Testing code</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#good-test-suites-are-thorough-but-realistic">Good test suites are thorough but realistic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structure-your-tests-to-reflect-how-the-code-works">Structure your tests to reflect how the code works</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-minimal-data-for-tests">Use minimal data for tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-your-test-code-to-mirror-your-codebase">Write your test code to mirror your codebase</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#good-tests-do-not-rely-on-external-states">Good tests do not rely on external states</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tests-are-documentation-and-tests-are-documented">Tests are documentation and tests are documented</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-bugs-to-improve-your-test-suite">Use bugs to improve your test suite</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#avoid-flickering-tests-by-making-them-deterministic">Avoid flickering tests by making them deterministic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#writing-tests-at-a-later-date">Writing tests at a later date</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#write-test-code-only-once">Write test code only once</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-fixtures-to-reduce-repetition">Use fixtures to reduce repetition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-parametrization-to-test-multiple-cases-at-once">Use parametrization to test multiple cases at once</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-tests-whenever-you-make-changes-to-your-project">Run tests whenever you make changes to your project</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-at-multiple-levels">Testing at multiple levels</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-testing">Unit testing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-testing">Integration testing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#systems-testing">Systems testing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-mocks-where-code-cannot-be-easily-decoupled">Use mocks where code cannot be easily decoupled</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="testing-code">
<h1>Testing code<a class="headerlink" href="#testing-code" title="Permalink to this headline">#</a></h1>
<p>Tests are bits of code that verify that your analytical code is working as expected.
Where code documentation helps others to understand what you expect your code to do,
testing assures that the the code meets these expectations.</p>
<p>Tests should be used proportionately across your codebase.
Hadley Wickham gives advice on designing test suites in
<a class="reference external" href="https://r-pkgs.org/testing-design.html#what-to-test">his book on writing packages for R</a>.
Although this book is written for R developers the advice at the start of the chapter is more general.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>When testing, ask: <strong>“Does my code do what I expect it to, given realistic inputs?”</strong>.</p>
<p>Delivering a piece of analysis or research includes both writing the code that performs your analysis and assuring that it works.
You cannot be sure that your code works without having run it with realistic examples.
Therefore, you must test your analytical code proportionately.</p>
<p>Tests can:</p>
<ul class="simple">
<li><p>verify that users expectations are met by the code,</p></li>
<li><p>define what code should do,</p></li>
<li><p>let you know when you’ve broken the expected functionality of your code,</p></li>
<li><p>be used to report or flag poor performance, for example, when modelling.</p></li>
</ul>
<p>Testing helps you assure your code quality and makes developing your code more efficient.
Code that has not been tested is more likely to contain bugs and require more maintenance in the future.</p>
<p>Code for testing should also follow good practice.
Testing is a useful and rewarding skill to learn.
You can learn basic testing that will immediately improve the quality of your code quickly.
However, it is usual for it to seem a daunting learning curve.</p>
</section>
<section id="good-test-suites-are-thorough-but-realistic">
<h2>Good test suites are thorough but realistic<a class="headerlink" href="#good-test-suites-are-thorough-but-realistic" title="Permalink to this headline">#</a></h2>
<blockquote>
<div><p>A quality assurance engineer walks into a bar. They order 1 beer.
They order 3.14 beers. They order -1 beers. They order 99999999999 beers. They order a lizard. They order <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
<p>The first customer walks in and asks where the bathroom is. The bar bursts into flames.</p>
</div></blockquote>
<p>When writing code outside dedicated testing frameworks, we manually test our code.
We might do this by running our code and seeing what the outputs are.
We test these outputs against our mental model - or understanding - of how the code should work.
Testing frameworks structure this process so that computers can automate the testing of the code.</p>
<p>Unfortunately, there’s no golden rule for exactly what you should test.
We can use general guides to direct where most of our testing effort goes.</p>
<p>Types of test - positive, negative (errors, if API). positive, negative, 0, NA.</p>
<p>You should:</p>
<ul class="simple">
<li><p>Focus on testing the most complex and vulnerable parts of your code</p></li>
<li><p>Focus on testing the “behaviour” of your code as opposed to the implementation</p></li>
<li><p>Write a new test every time you find a bug, to squash it for good</p></li>
<li><p>Focus on testing the most realistic use cases of your code</p></li>
<li><p>Test external interfaces - what happens if something unexpected is returned from one of your dependencies?</p></li>
<li><p>Document what your code should and shouldn’t be used for, to steer users towards the correct and tested usage</p></li>
</ul>
<p>You shouldn’t:</p>
<ul class="simple">
<li><p>Attempt to test every possible input and type of input</p></li>
<li><p>Focus on things that are already sufficiently tested
(e.g. it should not be necessary to test the functionality from your dependencies packages
if you are confident that they are already been subjected to sufficient assurance)</p></li>
<li><p>Write tests that have an element of randomness - tests should be deterministic</p></li>
</ul>
<p>You may want to use a short check-list for questions to ask when writing tests. For example:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span><span class="k">- [ ]</span> Have I tested realistic combinations of my code&#39;s input parameters?
<span class="k">- [ ]</span> Have I tested any discrete outputs once?
<span class="k">- [ ]</span> Have I tested the boundaries of non-discrete outputs?
<span class="k">- [ ]</span> Are informative errors raised when the code is not used in a valid or correct way?
<span class="k">- [ ]</span> Are informative warnings raised when the code is not used in a standard way?
</pre></div>
</div>
<p>Don’t worry if writing all of these tests sounds like a large task.
You’ll find that tests are repetitive, so we can reuse testing code to broaden the cases that our tests cover.
We’ll describe two useful ways of reducing the burden of writing and maintaining tests in a later section.</p>
<p>The examples in this section use these testing frameworks:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pytest</span></code> for Python</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">testthat</span></code> for R</p></li>
</ul>
<p>R users might also be interested in <code class="docutils literal notranslate"><span class="pre">assertthat</span></code>, which provides Python-like assertions in R.</p>
<p>Other common frameworks, which have a Class-based focus, are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">unittest</span></code> built into Python</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Runit</span></code> for R</p></li>
</ul>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Modelling-relevant testing
including <a class="reference external" href="https://www.jeremyjordan.me/testing-ml/">https://www.jeremyjordan.me/testing-ml/</a></p>
<p><a class="reference external" href="https://github.com/best-practice-and-impact/qa-of-code-guidance/issues/15">#15</a></p>
</div>
</section>
<section id="structure-your-tests-to-reflect-how-the-code-works">
<h2>Structure your tests to reflect how the code works<a class="headerlink" href="#structure-your-tests-to-reflect-how-the-code-works" title="Permalink to this headline">#</a></h2>
<p>Tests come in many shapes and sizes, but usually follow the pattern:</p>
<ol class="arabic simple">
<li><p>Arrange - set up any objects for your test, e.g. example input data and expected output data.</p></li>
<li><p>Act - run the code that you are testing (1 or more functions or methods).</p></li>
<li><p>Assert - verify that the code performed the expected action, e.g. that the output matched the expected output.</p></li>
</ol>
<p>We’ll use a couple of examples throughout this section of the book, to demonstrate how tests relate to analytical code.
Here we’ve a basic function to get the absolute equivalent of a number:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>

<span class="k">def</span> <span class="nf">absolute</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the non-negative equivalent of a real number.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Input number must be numeric.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">number</span> <span class="o">*</span> <span class="n">number</span><span class="p">)</span> 
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#&#39; Absolute</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; Get the non-negative equivalent of a real number.</span>

<span class="n">absolute</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">number</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">is.numeric</span><span class="p">(</span><span class="n">number</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nf">stop</span><span class="p">(</span><span class="s">&quot;Input number must be numeric.&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">number</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<p>To test that this function works as expected, we write code to carry out the test.
In Python this is another function, whereas in R it is simply a statement.
We’ve spread the code out over separate lines, to make it clear how this test follows the arrange, act, assert pattern:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_absolute_converts_negative_inputs</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Makes negative numbers positive.&quot;&quot;&quot;</span>
    <span class="c1"># Arrange</span>
    <span class="n">input_value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
    <span class="n">expected_output</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="c1"># Act</span>
    <span class="n">actual_output</span> <span class="o">=</span> <span class="n">absolute</span><span class="p">(</span><span class="n">input_value</span><span class="p">)</span>

    <span class="c1"># Assert</span>
    <span class="k">assert</span> <span class="n">actual_output</span> <span class="o">==</span> <span class="n">expected_output</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Arrange</span>
<span class="n">input_value</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">-5</span>
<span class="n">expected_output</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">5</span>

<span class="c1"># Act</span>
<span class="n">actual_output</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">absolute</span><span class="p">(</span><span class="n">input_value</span><span class="p">)</span>

<span class="c1"># Assert</span>
<span class="nf">test_that</span><span class="p">(</span><span class="s">&quot;absolute converts negative inputs to positive&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">expect_equal</span><span class="p">(</span><span class="n">expected_output</span><span class="p">,</span><span class="w"> </span><span class="n">actual_output</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>The example above can be described as a ‘unit test’.
This means that it tests the smallest unit of our code - a function.
There are three common “layers” of testing:</p>
<ul class="simple">
<li><p>Unit testing - assuring that functions or class methods perform as expected.</p></li>
<li><p>Integration testing - assuring that units interact with other units or third party code as expected.</p></li>
<li><p>End-to-end or system testing - assuring that a complete system functions as expected.</p></li>
</ul>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Acceptance_testing">User acceptance testing</a> is an additional level of software testing although it doesn’t involve writing test code.
It should be applied whenever developing software for users.</p>
<p>Each level of testing mitigates specific risks.</p>
<section id="use-minimal-data-for-tests">
<h3>Use minimal data for tests<a class="headerlink" href="#use-minimal-data-for-tests" title="Permalink to this headline">#</a></h3>
<p>Data for tests must be:</p>
<ul class="simple">
<li><p>only just large enough to carry out the test,</p></li>
<li><p>static (hardcoded), readable, fake and in the same folder as the tests (if unit test),</p></li>
<li><p>not generated by running your function then pasting it into the script,</p></li>
<li><p>larger for integration and end-to-end tests,</p></li>
<li><p>returned from a function or fixture for consistency.</p></li>
</ul>
</section>
<section id="write-your-test-code-to-mirror-your-codebase">
<h3>Write your test code to mirror your codebase<a class="headerlink" href="#write-your-test-code-to-mirror-your-codebase" title="Permalink to this headline">#</a></h3>
<p>Modular, well-structured code is easier to write tests for.
As such, testing encourages you to structure your code well.
Directories of testing code should mirror the source code directories.
You might want one file per function/class or one per module.
Overall, it should be easy to identify which functions or classes your tests are for.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">Python</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>project/
│
├── src/
│   ├── __init__.py
│   ├── math.py
│   ├── strings.py
│   └── api.py
│
└── tests/
    ├── unit/
    │   ├── __init__.py
    │   ├── test_math.py
    │   └── test_strings.py
    │
    ├── integration/
    │   ├── __init__.py
    │   └── test_sum.py
    │
    └── end_to_end/
        ├── __init__.py
        └── test_end_to_end.py
</pre></div>
</div>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>project/  
│  
├── .Rproj  
│  
├── R/  
│   ├── math.R  
│   ├── strings.R  
│   └── api.R  
│  
└── tests/  
    │  
    ├── testthat/  
    │   ├── test-maths_abs.R  
    │   ├── test-maths_sum.R  
    │   └── test-strings_option.R  
    │  
    └── testthat.R  
</pre></div>
</div>
</div></div>
</section>
<section id="good-tests-do-not-rely-on-external-states">
<h3>Good tests do not rely on external states<a class="headerlink" href="#good-tests-do-not-rely-on-external-states" title="Permalink to this headline">#</a></h3>
<p>Tests should be clean and easy to maintain.</p>
<p>Independent tests that do not rely on external states make maintenance easier.
Tests should not need to be run in a specific order.
Testing frameworks will often randomly order the tests when running them for this reason.</p>
<p>Likewise, tests should leave no trace.
Use set up and tear down code to manage this.
Some testing frameworks provide tools like fixtures or mocks to help with this.</p>
<p>Tests should be independent from the code.
If the code changes, the tests may fail but test functions should not break.</p>
</section>
<section id="tests-are-documentation-and-tests-are-documented">
<h3>Tests are documentation and tests are documented<a class="headerlink" href="#tests-are-documentation-and-tests-are-documented" title="Permalink to this headline">#</a></h3>
<p>Good tests describe what it is they are testing.
They do this by using good naming practices within the test code.
A good test suite should tell a story - given this data, having run this function, we expect this output.
Tests should follow the relevant practices outlined in <a class="reference internal" href="readable_code.html"><span class="doc std std-doc">Readable code</span></a>.</p>
<p>The story told in a testing suite helps developers understand what code is meant to do.
By defining expected outputs from given inputs, developers can understand the use of a particular piece of code.
Good testing suites recognise this and supplement other forms of documentation.</p>
</section>
<section id="use-bugs-to-improve-your-test-suite">
<h3>Use bugs to improve your test suite<a class="headerlink" href="#use-bugs-to-improve-your-test-suite" title="Permalink to this headline">#</a></h3>
<p>Every time you find a bug, write a test to check that it is fixed.
Doing so guarantees that your code covers common edge cases.
When you change your code or refactor your product you can be sure that bugs you have already fixed will not reappear.</p>
</section>
<section id="avoid-flickering-tests-by-making-them-deterministic">
<h3>Avoid flickering tests by making them deterministic<a class="headerlink" href="#avoid-flickering-tests-by-making-them-deterministic" title="Permalink to this headline">#</a></h3>
<p>Good tests are deterministic and repeatable.
Don’t use randomness when writing tests.
The only thing that should cause a test to fail when it has been passing is if the tested code has changed.
Running the same test with the same tested code should always produce the same outcome.</p>
<p>In short, a test should either pass or fail every time, not “mostly pass”.</p>
</section>
<section id="writing-tests-at-a-later-date">
<h3>Writing tests at a later date<a class="headerlink" href="#writing-tests-at-a-later-date" title="Permalink to this headline">#</a></h3>
<p>You should write tests when you write code.
However, this may not always be possible because of time, capability or tooling constraints.
Write test shells where you intend to write test - this highlights where testing is missing, which makes it easy to come back to later.</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Add more examples here</p>
<p><a class="reference external" href="https://github.com/best-practice-and-impact/qa-of-code-guidance/issues/116">#116</a></p>
</div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-3-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pytest
<span class="go">...</span>

<span class="go">snippets/pytest_example.py::test_absolute_converts_negative_inputs PASSED [ 25%]</span>
<span class="go">snippets/pytest_example.py::test_absolute_non_negative_inputs PASSED     [ 50%]</span>
<span class="go">snippets/pytest_example.py::test_absolute_non_numeric_raises PASSED      [ 75%]</span>
<span class="go">snippets/pytest_example.py::test_absolute_na SKIPPED                     [100%]</span>

<span class="go">===================== 3 passed, 1 skipped in 0.11 seconds =====================</span>
<span class="gp">                                                                                    $</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">if </span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">stop</span><span class="p">(</span><span class="s">&quot;Something has gone terribly wrong&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<p>Use <a class="reference internal" href="continuous_integration.html#continuous-integration"><span class="std std-ref">Continuous Integration</span></a> where possible as it keeps testing associated with version control.</p>
<p>Where manual testing is carried out instead of writing test code, this must be documented to create an audit trail.
This documentation should include what has been tested and who has approved that it works as expected.</p>
</section>
</section>
<section id="write-test-code-only-once">
<h2>Write test code only once<a class="headerlink" href="#write-test-code-only-once" title="Permalink to this headline">#</a></h2>
<p>Where possible, reduce repetition in your tests. Tests are code too, so you should still <a class="reference internal" href="modular_code.html#functions"><span class="std std-ref">make this code reusable</span></a>.
Tests need not be totally singular, but, as with non-test code, repetition makes maintenance of test code more difficult and risky .
As with functional code, test code is much easier to maintain when it is modular and reusable.</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>Add examples to reducing repetition in tests to demonstrate these</p>
<p><a class="reference external" href="https://github.com/best-practice-and-impact/qa-of-code-guidance/issues/29">#29</a></p>
</div>
<section id="use-fixtures-to-reduce-repetition">
<h3>Use fixtures to reduce repetition<a class="headerlink" href="#use-fixtures-to-reduce-repetition" title="Permalink to this headline">#</a></h3>
<p>As your test suite grows, many of your tests may use similar code to prepare your tests or to clean up after each test has run.
Copying these code snippets for each test is laborious and increases the risk of applying those steps inconsistently.</p>
<p>Fixtures help us to avoid this form of repetition in our tests.
With a fixture, you define your test preparation and clean up as functions.
You then use the fixture to carry out these steps consistently for each test that they are required for.</p>
<p>In Class-based testing frameworks, these functions tend to be separated into <code class="docutils literal notranslate"><span class="pre">SetUp</span></code> and <code class="docutils literal notranslate"><span class="pre">TearDown</span></code> functions.
These are set to run before and after each test, respectively.</p>
<p>Fixtures can be most useful when setting up a test object takes a large amount of time or resource.
They can be designed to run for each test, once for a group of tests or once for the whole test suite.
They are also useful for undoing the effects of each test run on the global environment.
For example, they can remove test data which has been written to a temporary file or database.</p>
<p>Reference material:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.pytest.org/en/stable/fixture.html">Python <code class="docutils literal notranslate"><span class="pre">pytest</span></code> Fixture</a> documentation</p></li>
<li><p><a class="reference external" href="https://testthat.r-lib.org/articles/test-fixtures.html">R <code class="docutils literal notranslate"><span class="pre">testthat</span></code> Fixture</a> documentation</p></li>
</ul>
</section>
<section id="use-parametrization-to-test-multiple-cases-at-once">
<h3>Use parametrization to test multiple cases at once<a class="headerlink" href="#use-parametrization-to-test-multiple-cases-at-once" title="Permalink to this headline">#</a></h3>
<p>Often, similar steps are taken when testing multiple combinations of inputs and outputs.
Parametrization allows us to reduce repetition in our code, in a similar way to reusable functions.
We specify the pairs of inputs and expected outputs, so that our testing tool can repeat a test for each scenario.</p>
<p>This approach is equivalent to using a for-loop to apply a test function over multiple inputs and expected outputs.
Using functionality from test packages may improve running efficiency and the detail given in test logs.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">pytest</span></code>, this can be achieved using the <a class="reference external" href="https://docs.pytest.org/en/stable/parametrize.html">Parametrize mark</a>.</p>
<p>In R, the <code class="docutils literal notranslate"><span class="pre">patrick</span></code> package extends <code class="docutils literal notranslate"><span class="pre">testthat</span></code> to provide a
<a class="reference external" href="https://rdrr.io/cran/patrick/man/with_parameters_test_that.html"><code class="docutils literal notranslate"><span class="pre">with_parameters_test_that</span></code></a> function to achieve this.</p>
</section>
</section>
<section id="run-tests-whenever-you-make-changes-to-your-project">
<h2>Run tests whenever you make changes to your project<a class="headerlink" href="#run-tests-whenever-you-make-changes-to-your-project" title="Permalink to this headline">#</a></h2>
<p>Tests should be run whenever you make changes to your project.
This ensures that changes do not break the existing, intended functionality of your code.
Where tests fail, fix these before adding changes to a stable or production version of your code.</p>
<p>If you have altered the functionality of your code, this will likely break existing tests.
Failing tests are a good reminder that you should update your documentation and tests to reflect the new functionality.</p>
<p>If your collection of tests runs quickly, it’s simplest to run them all often. This has the added benefit of capturing unexpected side-effects of your changes.
For example, you might pick up an unexpected failure in part of your code that you have not directly changed.</p>
<p>To ensure that tests are run consistently every time changes to code are made, you should automate the process using <a class="reference internal" href="continuous_integration.html#automate-tests"><span class="std std-ref">continuous integration</span></a>.</p>
</section>
<section id="testing-at-multiple-levels">
<h2>Testing at multiple levels<a class="headerlink" href="#testing-at-multiple-levels" title="Permalink to this headline">#</a></h2>
<p>Each level is important for different reasons.</p>
<section id="unit-testing">
<h3>Unit testing<a class="headerlink" href="#unit-testing" title="Permalink to this headline">#</a></h3>
<div class="admonition-learning admonition">
<p class="admonition-title">Key Learning</p>
<p>You should follow the <a class="reference external" href="https://learninghub.ons.gov.uk/course/view.php?id=499">Introduction to Unit Testing course</a> for applied examples in Python and R.
The course also covers writing and documenting functions, and error handling.</p>
<p>Other resources include:</p>
<ul class="simple">
<li><p>Hadley Wickham’s <a class="reference external" href="https://vita.had.co.nz/papers/testthat.pdf">testthat: getting started with testing</a></p></li>
<li><p><a class="reference external" href="https://docs.pytest.org/en/3.0.1/getting-started.html"><code class="docutils literal notranslate"><span class="pre">pytest</span></code> getting started</a></p></li>
<li><p>Real Python <a class="reference external" href="https://realpython.com/python-testing/">Getting Started With Testing in Python</a></p></li>
</ul>
</div>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>Testing in multiple environments?</p>
<ul class="simple">
<li><p><a class="reference external" href="https://tox.readthedocs.io/en/latest/">tox</a>/<a class="reference external" href="https://nox.thea.codes/en/stable/">nox</a></p></li>
<li><p><a class="reference external" href="https://r-hub.github.io/rhub/">rhub</a></p></li>
</ul>
</div>
</section>
<section id="integration-testing">
<h3>Integration testing<a class="headerlink" href="#integration-testing" title="Permalink to this headline">#</a></h3>
</section>
<section id="systems-testing">
<h3>Systems testing<a class="headerlink" href="#systems-testing" title="Permalink to this headline">#</a></h3>
</section>
</section>
<section id="use-mocks-where-code-cannot-be-easily-decoupled">
<h2>Use mocks where code cannot be easily decoupled<a class="headerlink" href="#use-mocks-where-code-cannot-be-easily-decoupled" title="Permalink to this headline">#</a></h2>
<p>Tests should be specific.</p>
<p>If you can’t refactor the code to make it easier to test specific aspects, then Mocks can be useful for removing unwanted factors.
Mocking is useful for removing things that we don’t care about from the the test. But should not be used to avoid testing complex parts of code that you’ve written.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="peer_review.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Peer review</p>
      </div>
    </a>
    <a class="right-next"
       href="continuous_integration.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Automating code quality assurance</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#good-test-suites-are-thorough-but-realistic">Good test suites are thorough but realistic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structure-your-tests-to-reflect-how-the-code-works">Structure your tests to reflect how the code works</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-minimal-data-for-tests">Use minimal data for tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-your-test-code-to-mirror-your-codebase">Write your test code to mirror your codebase</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#good-tests-do-not-rely-on-external-states">Good tests do not rely on external states</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tests-are-documentation-and-tests-are-documented">Tests are documentation and tests are documented</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-bugs-to-improve-your-test-suite">Use bugs to improve your test suite</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#avoid-flickering-tests-by-making-them-deterministic">Avoid flickering tests by making them deterministic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#writing-tests-at-a-later-date">Writing tests at a later date</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#write-test-code-only-once">Write test code only once</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-fixtures-to-reduce-repetition">Use fixtures to reduce repetition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-parametrization-to-test-multiple-cases-at-once">Use parametrization to test multiple cases at once</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-tests-whenever-you-make-changes-to-your-project">Run tests whenever you make changes to your project</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-at-multiple-levels">Testing at multiple levels</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-testing">Unit testing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-testing">Integration testing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#systems-testing">Systems testing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-mocks-where-code-cannot-be-easily-decoupled">Use mocks where code cannot be easily decoupled</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>Analysis Function - Analytical Standards and Pipelines hub</p><p>This is a living document, please help use to make it grow by providing any feedback <a href='mailto:ASAP@ons.gov.uk'>by email</a> or via the <a href='https://github.com/best-practice-and-impact/qa-of-code-guidance'>GitHub repository</a>.
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>