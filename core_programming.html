
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Core programming practices &#8212; DRAFT: Quality Assurance of Code for Analysis and Research</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/markdown_within_tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/logo.css" />
    <link rel="stylesheet" type="text/css" href="_static/admonitions.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="_static/doctools.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Structuring your project" href="project_structure.html" />
    <link rel="prev" title="Principles" href="principles.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/duck_book_logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">DRAFT: Quality Assurance of Code for Analysis and Research</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Guidance
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="principles.html">
   Principles
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Core programming practices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project_structure.html">
   Structuring your project
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code_documentation.html">
   Code documentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project_documentation.html">
   Project documentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="version_control.html">
   Version control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="configuration.html">
   Configuration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data.html">
   Data Management
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="peer_review.html">
   Peer review
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="testing_code.html">
   Testing code
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="learning.html">
   Learning Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tools.html">
   Tools
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <p>Book version 2021.0</><a href='https://gss.civilservice.gov.uk/' target='_blank'><img src='./_static/GSS_logo.jpg' alt='The Government Statistical Service logo' style='width:100%'></a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/core_programming.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/best-practice-and-impact/qa-of-code-guidance"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/best-practice-and-impact/qa-of-code-guidance/issues/new?title=Issue%20on%20page%20%2Fcore_programming.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/best-practice-and-impact/qa-of-code-guidance/edit/master/core_programming.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modular-code">
   Modular code
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functions">
     Functions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classes">
     Classes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scripts">
     Scripts
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modules">
     Modules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#packages">
     Packages
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebooks">
   Notebooks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clean-code">
   Clean code
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#naming">
     Naming
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#naming-variables">
       Naming variables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#naming-functions">
       Naming functions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#naming-classes">
       Naming classes
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#code-style">
     Code style
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#idiomatic-code">
       Idiomatic code
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#checking-code-style">
       Checking code style
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#software-ideas-for-analysts">
   Software ideas for analysts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#keep-it-simple">
     Keep it simple
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#don-t-repeat-yourself">
     Don’t Repeat Yourself
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#be-explicit">
     Be explicit
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#separate-responsibilities">
     Separate responsibilities
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#open-closed">
     Open-closed
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="core-programming-practices">
<h1>Core programming practices<a class="headerlink" href="#core-programming-practices" title="Permalink to this headline">¶</a></h1>
<p>The principles outlined in this chapter represent good practices for general programming and software development. These have been tailored to a more analytical workflow.</p>
<div class="admonition-learning admonition">
<p class="admonition-title">Pre-requisites</p>
<p>To get the most benefit from this section, you should have an understanding of core programming concepts such as:</p>
<ul class="simple">
<li><p>storing information in variables</p></li>
<li><p>using control flow, such as if-statements and for-loops</p></li>
<li><p>writing code as functions or classes</p></li>
<li><p>using functions or classes in your code</p></li>
</ul>
<p>You can find links to relevant training in the <a class="reference internal" href="learning.html"><span class="doc std std-doc">Learning Resources</span></a> section of the book.</p>
</div>
<div class="section" id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<blockquote class="epigraph">
<div><p>Code is read more often than it is written.</p>
<p class="attribution">—Guido van Rossum (creator of Python)</p>
</div></blockquote>
<p>When writing code, we should expect that at some point someone else will need to understand, use and adapt it. This might be yourself in six months time. As such, it is important to empathise with these potential users and write code that is tidy, understandable and does not add unnecessary complexity.</p>
<p>Common barriers to writing readable code include: documentation that is hard to understand or absent, walls of repetitive code that is hard to absorb, or over-complicated code where a simpler solution could be used. Avoiding these issues is essential to make sure that your analysis is reproducible, auditable and assured. Therefore it is our professional responsibility to avoid putting such barriers in place whenever possible.</p>
<p>This chapter highlights good coding practices that will improve the readability and maintainability of your code. Here, readability refers to how easily another analyst can gain a decent understand of how your code works, within a reasonable amount of time. Maintainability refers to how easily other analysts can understand your code well enough to modify and repair it.</p>
</div>
<div class="section" id="modular-code">
<span id="modular"></span><h2>Modular code<a class="headerlink" href="#modular-code" title="Permalink to this headline">¶</a></h2>
<p>Breaking your code down into smaller, more manageable chunks is a sensible way to improve readability. Regardless of the language, there are often techniques to containerise your code into self-contained parts such as modules, classes or functions.</p>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<p>In the early stages of analysis we often copy and paste code to ‘make it work’. As this work matures, it is worth taking repetitive code and turning it into functions. Functions allow us to make a  piece of logic reusable in a consistent and readable way, and also makes it easier for us to <a class="reference internal" href="testing_code.html"><span class="doc std std-doc">test our logic</span></a>.</p>
<p>When starting to write functions, you should consider what is the right level of complexity for a single function. Namely, can the code containing my logic be turned into a concise and readable function as it is, without having to pass too many arguments to the resulting function? If not, it might be better to break the code into multiple smaller functions and then use these smaller functions to build up a larger high-level function that performs the group of actions that you need. These smaller functions might also be used in other places in your code. For example, in other high-level functions that perform similar tasks.</p>
<p>This approach helps you break complex logic down into small, understandable chunks that can be documented and tested more easily.</p>
<p>When writing functions, it’s also important to consider how they interact with other parts of your code. As a general rule of thumb, your code should run in the same way if a call to your function was replaced by the value that it would have returned. This is referred to as ‘referential transparency’.</p>
<p>In practice, this means that your functions should not depend-on or affect variables that have not been explicitly fed into them as arguments. For instance, a function should not add columns to a data table that has not been passed as an input to the function. Nor should the action of a function be affected by anything other than arguments that are passed to it. For example, running your function twice with the same inputs should always produce the same results.</p>
<p>Avoiding such behaviours makes your code more transparent; it will be easier for users and developers to understand which functions affect which data without being concerned about hidden behaviours.
In turn, this makes it easier to locate bugs in the code and assure its function by peer review.</p>
<p>When it is not possible or practical to follow these practices, you should ensure that any ‘side-effects’ are adequately documented for both users and developers. This may be the case where your code interacts with a file, database or an external service. Ultimately, if you do signal where these kind of things might happen, someone trying to debug issues will know where to look.</p>
<p>To summarise:</p>
<ul class="simple">
<li><p>Make sure that functions are not too overcomplicated; break down your code into smaller functions and build up your functionality with larger functions from these small building blocks.</p></li>
<li><p>Minimise the ‘side-effects’ of functions in order to make sure that your code is easy to debug and is transparent in its functionality.</p></li>
<li><p>Strive to make sure that running your function with the same inputs will produce the same results every time.</p></li>
</ul>
</div>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<p>Classes are fundamental parts of <a class="reference external" href="https://en.wikipedia.org/wiki/Object-oriented_programming">object-orientated programming (OOP)</a>. They create an association between data (attributes of the class) and logic (methods of the class). As you will see in the examples below, classes can be useful when representing real objects in our code.</p>
<p>Although classes do exist in R, they are more widely used in Python (and other OOP enabling languages). Hence the following sub-section will focus primarily on Python classes.</p>
<p>With a more complex system, OOP can help to reduce complexity by hiding low-level details from users, such as internal state.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ‘state’ of an object is usually a set of variables that are particular to a given instance of a class. To illustrate, imagine a bank account that is represented by an <code class="docutils literal notranslate"><span class="pre">Account</span></code> class. You can have many <em>instances</em> of this class (many unique bank accounts), each defined by the following internal state:</p>
<ul class="simple">
<li><p>owner name</p></li>
<li><p>account number</p></li>
<li><p>balance</p></li>
</ul>
</div>
<p>Since the end user does not need to know all of the state associated with an object, when writing classes consider marking such state as ‘private’. This prevents users from accessing attributes directly, instead accessing them through class methods (functions defined with the class).</p>
<div class="admonition-method-vs-function admonition">
<p class="admonition-title">Method vs Function</p>
<p>When talking about methods, we mean functions that are strictly ‘attached’ to a given class. The following example illustrates the difference between the two:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining a class with a diagnose method</span>
<span class="k">class</span> <span class="nc">Car</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A car class&quot;&quot;&quot;</span>
    <span class="n">wheels</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brand</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">brand</span> <span class="o">=</span> <span class="n">brand</span>

    <span class="k">def</span> <span class="nf">diagnose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>

<span class="c1"># versus defining a standalone diagnosis function</span>
<span class="k">def</span> <span class="nf">diagnose</span><span class="p">(</span><span class="n">car</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A car diagnosis function&quot;&quot;&quot;</span>
    <span class="o">...</span>


<span class="c1"># Calling a method on a class instance that holds it&#39;s own state</span>
<span class="n">cadillac</span> <span class="o">=</span> <span class="n">Car</span><span class="p">(</span><span class="n">brand</span><span class="o">=</span><span class="s2">&quot;Cadillac&quot;</span><span class="p">)</span>
<span class="n">cadillac</span><span class="o">.</span><span class="n">diagnose</span><span class="p">()</span>

<span class="c1"># Calling a function by passing all relevant information explicitly</span>
<span class="c1"># Note: for the sake of variety the information about the car is represented in a dictionary</span>
<span class="n">diagnose</span><span class="p">({</span><span class="s2">&quot;brand&quot;</span><span class="p">:</span><span class="s2">&quot;Cadillac&quot;</span><span class="p">,</span> <span class="s2">&quot;wheels&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
</pre></div>
</div>
</div>
<p>In some languages ‘private’ state can be used to prevent access to parts of your class. In Python <a class="reference external" href="https://docs.python.org/3/tutorial/classes.html#private-variables">truly private instance variables do not exist</a>, so it is not possible to prevent access to any part of your class. The standard convention in Python is to prefix attribute names with a single underscores (<code class="docutils literal notranslate"><span class="pre">_my_class_attribute</span></code>) to indicate that users shouldn’t be concerned with these attributes.</p>
<p>In addition to private attributes, you can use the same naming convention to indicate that a method is ‘private’ and should not be used by users. This can be useful when writing reusable low-level methods within an object, analogous to breaking a large function down into multiple smaller functions. These private methods can then be called by high-level methods that are exposed to users.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>In Python, the notion of ‘private’ does not mean secure. The main goal of private attributes and methods is to expose less unnecessary information to the anyone using your class in their code.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BankAccount</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">balance</span><span class="p">,</span> <span class="n">credentials</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_balance</span> <span class="o">=</span> <span class="n">balance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_credentials</span> <span class="o">=</span> <span class="n">credentials</span>

    <span class="k">def</span> <span class="nf">_private_withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Private withdrawal helper method.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_balance</span> <span class="o">-=</span> <span class="n">amount</span>

    <span class="k">def</span> <span class="nf">_check_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">credentials</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Private check helper method.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">credentials</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_credentials</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">credentials</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Public withdrawal method.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_check_credentials</span><span class="p">(</span><span class="n">credentials</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_private_withdraw</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
</pre></div>
</div>
<p>When using classes in our code, we care more about what methods a class provides than what <code class="docutils literal notranslate"><span class="pre">type</span></code> it is defined as. This is known as ‘duck typing’; if a class has the same methods as another class, then you can use either class in your code.</p>
<blockquote>
<div><p>If it walks like a duck, and it quacks like a duck, then it must be a duck.</p>
</div></blockquote>
<p>Given the example above, if we created a class <code class="docutils literal notranslate"><span class="pre">LoyaltyAccount</span></code> with the same <code class="docutils literal notranslate"><span class="pre">withdraw</span></code> method for withdrawing points, we could feasible switch between using the <code class="docutils literal notranslate"><span class="pre">BankAccount</span></code> and <code class="docutils literal notranslate"><span class="pre">LoyaltyAccount</span></code> classes without affecting how our code runs.</p>
<p>Object-Orientated Programming introduces the concept of inheritance - where a class can ‘inherit’ methods from another class in order to extend it. In this situation, a new class ‘subclasses’ the ‘superclass’ or ‘parent’ that it is inheriting from. When defining multiple classes with similar functionality, inheritance can be used to store the shared logic in a separate class type, which we can then extend by subclassing. For example, we might create an <code class="docutils literal notranslate"><span class="pre">Account</span></code> class to store a <code class="docutils literal notranslate"><span class="pre">balance</span></code> and the logic behind our <code class="docutils literal notranslate"><span class="pre">withdraw</span></code> method. Our <code class="docutils literal notranslate"><span class="pre">BankAccount</span></code> and <code class="docutils literal notranslate"><span class="pre">LoyaltyAccount</span></code> could then subclass <code class="docutils literal notranslate"><span class="pre">Account</span></code> to extend it with any additional logic that is specific to their account types.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov substitution</a> states that subclasses should not damage the functionality of their parent class in their implementation.
They should extend their usefulness, but retain their original functionality. If our <code class="docutils literal notranslate"><span class="pre">BankAccount</span></code> class inherits from <code class="docutils literal notranslate"><span class="pre">Account</span></code> we should consider that ‘a <code class="docutils literal notranslate"><span class="pre">BankAccount</span></code> is an <code class="docutils literal notranslate"><span class="pre">Account</span></code>’. Liskov substitution strengthens this statement to ‘<code class="docutils literal notranslate"><span class="pre">BankAccount</span></code> is interchangeable with an <code class="docutils literal notranslate"><span class="pre">Account</span></code>’; we can replace any <code class="docutils literal notranslate"><span class="pre">Account</span></code> with <code class="docutils literal notranslate"><span class="pre">BankAccount</span></code> without changing how our code runs. This is because <code class="docutils literal notranslate"><span class="pre">BankAccount</span></code> provides all of the same methods that an <code class="docutils literal notranslate"><span class="pre">Account</span></code> does, no less.</p>
<p>This can be similarly applied to functions. If you were to increase the domain and range of a function, to account for new cases, then this function should observe the same interface as the previous function.</p>
<p>In short:</p>
<ul class="simple">
<li><p>Objects should be replaceable with instances of their subclasses, without altering the correctness of that program.</p></li>
<li><p>Functions should be replaceable with similar functions that share the same interface.</p></li>
</ul>
</div>
<p>However, we should be wary that inheritance locks our class in to the object that it inherits from. If the superclass changes, our class is forced to change with it. When using inheritance to reuse code from an unrelated class, ‘encapsulation’ may be more appropriate. For example, a <code class="docutils literal notranslate"><span class="pre">Car</span></code> class might want use a method from an <code class="docutils literal notranslate"><span class="pre">Engine</span></code> class, but a car could not be substituted for an engine. It would not be suitable for <code class="docutils literal notranslate"><span class="pre">Car</span></code> to inherit from <code class="docutils literal notranslate"><span class="pre">Engine</span></code>. Therefore, you might keep a private instance of the <code class="docutils literal notranslate"><span class="pre">Engine</span></code> class you wish to re-use, and delegate the work down to it in the <code class="docutils literal notranslate"><span class="pre">Car</span></code> methods. Then, if you change your mind about using this <code class="docutils literal notranslate"><span class="pre">Engine</span></code> class in your <code class="docutils literal notranslate"><span class="pre">Car</span></code> class, you aren’t tied to it and can easily replace it.</p>
<p id="interfaces">In OOP, an ‘interface’ can be defined to act a blueprint or specification for writing classes. An interface outlines the attributes and methods that a class must provide to be considered equivalent to a group of classes. Perhaps we want to use classes to read and write data - this might require several different classes, with <code class="docutils literal notranslate"><span class="pre">read</span></code> and <code class="docutils literal notranslate"><span class="pre">write</span></code> methods for different file formats. For example, one class could deal with storing data into a database, and another could store data in local <code class="docutils literal notranslate"><span class="pre">.csv</span></code> files instead. In our code, we could switch which class is provided to downstream functions. Our functions don’t need to know if they are reading or writing from databases or <code class="docutils literal notranslate"><span class="pre">.csv</span></code> files, however, they do require the <code class="docutils literal notranslate"><span class="pre">read</span></code> and <code class="docutils literal notranslate"><span class="pre">write</span></code> methods of the class to work in a standard way. An <code class="docutils literal notranslate"><span class="pre">interface</span></code> would help to define the standard for interacting with this group of classes.</p>
<p>In Python, the <code class="docutils literal notranslate"><span class="pre">abc</span></code> module allows us to define <a class="reference external" href="https://docs.python.org/3/library/abc.html">‘abstract’ base classes and methods</a> to enforce that our classes provide the required methods. When a subclass does not implement the required abstract methods, instances of the class cannot be created. These abstract base classes achieve the same as interfaces in other object-based languages. We can illustrate this concept in the following example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>


<span class="k">class</span> <span class="nc">FileHandler</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An abstract class for reading and writing&quot;&quot;&quot;</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="k">pass</span>


<span class="k">class</span> <span class="nc">CsvHandler</span><span class="p">(</span><span class="n">FileHandler</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
       <span class="k">return</span> <span class="n">write_to_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
       <span class="n">data</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
       <span class="n">data</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
       <span class="n">data</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
       <span class="k">return</span> <span class="n">data</span>


<span class="k">class</span> <span class="nc">SqlHandler</span><span class="p">(</span><span class="n">FileHandler</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
       <span class="n">connect_to_database</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_url</span><span class="p">)</span>
       <span class="k">return</span> <span class="n">write_to_database</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
       <span class="n">data</span> <span class="o">=</span> <span class="n">read_from_database</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_url</span><span class="p">)</span>
       <span class="n">data</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
       <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>When multiple classes have a similar application programming interface (API, i.e. the methods they supply for users), we can easily switch between them. A good real-world example of this can be seen in the <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> package, where the different linear model types are represented by different classes. Each linear model class supports a common set of methods, e.g. <code class="docutils literal notranslate"><span class="pre">fit()</span></code> and <code class="docutils literal notranslate"><span class="pre">predict()</span></code>. As such, any model can then be used in a pipeline and swapped out with minimal effort. Therefore, when thinking about how to break you code up into classes consider the use of standardised methods across similar objects to make them interchangeable.</p>
<div class="admonition note" id="class-responsibilities">
<p class="admonition-title">Note</p>
<p>A word of caution, when creating your own classes. It is easy to start to mapping nouns in system descriptions to classes, and any adjectives applied to the nouns as methods. For example: ‘the model loads the data’, which implies that <code class="docutils literal notranslate"><span class="pre">Model</span></code> is a class that should have a <code class="docutils literal notranslate"><span class="pre">load_data</span></code> method. This works well for small systems, but as the complexity of your code grows you might find that one of your classes gains the majority of the underlying logic. This often leads to one class with many methods, whilst other classes just store data with very few methods. This can be described as ‘Data Driven Design’.</p>
<p>When most of your code resides in a single class, this can indicate that this class is responsible for too much of your code’s logic. This class might become overly complex and hence difficult to maintain. Consequently, changes to requirements will cause this one class to change, which may affect other unrelated functionality in the class.</p>
<p>For more complex analytical work, a better approach might be <a class="reference external" href="https://en.wikipedia.org/wiki/Responsibility-driven_design">Responsibility Driven Design</a>. Here, we write small classes with a focussed responsibility. This reduces complexity and helps classes to avoid being affected by changes to other, unrelated parts of our code. However, be aware of the trade-off between the complexity of one large class versus many smaller classes.</p>
</div>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Responsibility-driven_design">Responsibility Driven Design</a> makes objects that are usually ‘passive’ become ‘active’. For example, with a banking system, an  object representing a bank account, and handling all money movements, might become overly complex. Instead, objects representing <code class="docutils literal notranslate"><span class="pre">Cheque</span></code>s and <code class="docutils literal notranslate"><span class="pre">Cash</span></code> might be designed with payment methods. In this situation, a <code class="docutils literal notranslate"><span class="pre">Cheque</span></code> knows how much money it contains and how to pay itself into an account. A <code class="docutils literal notranslate"><span class="pre">Cheque</span></code>’s responsibility is to retrieve money from its associated account and pay itself in to another bank account. If we later needed to add new payment methods, the existing payment type classes (<code class="docutils literal notranslate"><span class="pre">Cheque</span></code> and <code class="docutils literal notranslate"><span class="pre">Cash</span></code>) will unlikely to be affected. The bank account’s responsibility is holding money, receiving it and paying it out.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Many <a class="reference external" href="https://en.wikipedia.org/wiki/Software_design_pattern">Design Patterns</a> are available with OOP. These are reusable solutions to common problems.</p>
</div>
<p>Finally, be wary when using classes to ‘chain’ methods together. For instance, if a ‘book’ has a ‘publisher’ and the publisher has an ‘address’, you could write <code class="docutils literal notranslate"><span class="pre">book.publisher().address().postcode()</span></code>. However, chains like this are fragile as they depend on multiple parts of the system not changing. The ‘Demeter’ research project found that this style of code produce a high proportion of bugs, resulting in the <a class="reference external" href="https://en.wikipedia.org/wiki/Law_of_Demeter">Law of Demeter</a>: ‘Only talk to your immediate friends’. Namely, only access the objects you know about directly within a class. This reduces the opportunity for your code to be damaged by a change in your dependencies. There is a penalty for this - you replace with <code class="docutils literal notranslate"><span class="pre">book.publisherPostcode()</span></code> which internally would call <code class="docutils literal notranslate"><span class="pre">publisher.postcode()</span></code>, so we’ve added a method to <code class="docutils literal notranslate"><span class="pre">publisher</span></code> as well as <code class="docutils literal notranslate"><span class="pre">book</span></code>; we’re trading maintainability for complexity, so consider if it is worthwhile.</p>
<p>To summarise:</p>
<ul class="simple">
<li><p>Classes hide implementation detail from users, enabling implementation to be changed without affecting users.</p></li>
<li><p>Look to use consistent methods in a group of related classes, so that you can switch between them without affecting the code using it. Consider Python ‘duck typing’ or abstract classes and methods.</p></li>
<li><p>Avoid storing all logic in a single class. Instead, distribute logic based on responsibilities.</p></li>
<li><p>Be aware of trading maintainability for complexity - one large class or too many classes can be hard to understand.</p></li>
<li><p>Design Patterns have solutions to many common problems and are a useful toolbox.</p></li>
<li><p>Prefer encapsulation over inheritance, especially with code reuse.</p></li>
</ul>
</div>
<div class="section" id="scripts">
<h3>Scripts<a class="headerlink" href="#scripts" title="Permalink to this headline">¶</a></h3>
<p>Scripts are simply files containing code that you would like to execute. In Python you commonly have a <code class="docutils literal notranslate"><span class="pre">main.py</span></code> script that orchestrates part of your codebase to achieve an outcome. In machine-learning projects, you sometimes have <code class="docutils literal notranslate"><span class="pre">train.py</span></code> and <code class="docutils literal notranslate"><span class="pre">test.py</span></code> which are scripts that train the model and produce performance metrics.</p>
<p>Scripts, if written well, are reproducible. In languages like R and Python, when executed from the command line using commands like <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">main.py</span></code> they are read top to bottom and executed line by line. This is in contrast to running code in an interactive interpreter or notebook, where the human has control of the order of execution. Manually executing individual lines of code allows for a slew of errors when things are run in the wrong order.</p>
<p>Ultimately for code pipelines you will need to have some way of running your code - the humble script is the primary way of orchestrating your functions and classes in a pipeline fashion.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Including something that is not reproducible in a script will not make it more reproducible. The script is simply a tool to run code in the same fashion across multiple runs.</p>
</div>
<p>To summarise:</p>
<ul class="simple">
<li><p>Scripts are a good way to orchestrate your functions and classes in order to build a simple, yet effective pipeline.</p></li>
<li><p>They are text documents containing source code, which makes them easily human readable and auditable.</p></li>
<li><p>They can be broken down into sections using <a class="reference internal" href="code_documentation.html"><span class="doc std std-doc">comments</span></a> for readability.</p></li>
</ul>
</div>
<div class="section" id="modules">
<span id="id1"></span><h3>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h3>
<p>Simply put, modules are scripts that contain functions that you want to use in other scripts. As you write your code and find opportunities to create classes or functions that reduce repetition and promote easier code comprehension, you might decide that you want these functions to sit outside of your main pipeline script. This is where modules come in, to separate reusable code into logical groups.</p>
<p>Consider a project where an analyst has created one large data analysis script. Upon reflection, they decide to split the logic from their pipeline into groups of functions relating to ‘data processing’, ‘data modelling’ and ‘result presentation’. They then create a file to contain each of these groups of functions: <code class="docutils literal notranslate"><span class="pre">processing.py</span></code>, <code class="docutils literal notranslate"><span class="pre">modelling.py</span></code> and <code class="docutils literal notranslate"><span class="pre">reporting.py</span></code>. They decide that they want to have a pipeline script called <code class="docutils literal notranslate"><span class="pre">main</span></code>, but they want to keep this script readable and simple.  Their directory now looks something similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project</span>
<span class="o">|</span> <span class="n">main</span><span class="o">.</span><span class="n">py</span>
<span class="o">|</span> <span class="n">modelling</span><span class="o">.</span><span class="n">py</span>
<span class="o">|</span> <span class="n">processing</span><span class="o">.</span><span class="n">py</span>
<span class="o">|</span> <span class="n">reporting</span><span class="o">.</span><span class="n">py</span>
<span class="o">|</span> <span class="n">README</span><span class="o">.</span><span class="n">md</span>
</pre></div>
</div>
<p>They then import the relevant functions into <code class="docutils literal notranslate"><span class="pre">main.py</span></code> from their modules as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">modelling</span> <span class="kn">import</span> <span class="n">predict_results</span>
<span class="kn">from</span> <span class="nn">processing</span> <span class="kn">import</span> <span class="n">clean</span><span class="p">,</span> <span class="n">preprocess</span>
<span class="kn">from</span> <span class="nn">reporting</span> <span class="kn">import</span> <span class="n">generate_report</span><span class="p">,</span> <span class="n">export</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/path.csv&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">preprocess</span><span class="p">(</span><span class="n">clean</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">predict_results</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">generate_report</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="n">export</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a minimal example of a pipeline script, illustrating how you might import reusable functions from other modules. This <code class="docutils literal notranslate"><span class="pre">main.py</span></code> script lacks the ability to configure things like the path to the input data. This requires users to manually alter file paths in the code, which is highly discouraged.</p>
</div>
<div class="admonition-a-step-further admonition">
<p class="admonition-title">A step further</p>
<p>Another step that can be taken to introduce clarity is to further wrap these modules into their own folder like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project</span>
<span class="o">|</span> <span class="n">library</span>
  <span class="o">|</span> <span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
  <span class="o">|</span> <span class="n">modelling</span><span class="o">.</span><span class="n">py</span>
  <span class="o">|</span> <span class="n">processing</span><span class="o">.</span><span class="n">py</span>
  <span class="o">|</span> <span class="n">reporting</span><span class="o">.</span><span class="n">py</span>
<span class="o">|</span> <span class="n">LICENSE</span>
<span class="o">|</span> <span class="n">main</span><span class="o">.</span><span class="n">py</span>
<span class="o">|</span> <span class="n">README</span><span class="o">.</span><span class="n">md</span>
</pre></div>
</div>
<p>And the expected python code then can be structured as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Import required modules from functions</span>
<span class="kn">from</span> <span class="nn">library.modelling</span> <span class="kn">import</span> <span class="n">predict_results</span>
<span class="kn">from</span> <span class="nn">library.processing</span> <span class="kn">import</span> <span class="n">clean</span><span class="p">,</span> <span class="n">preprocess</span>
<span class="kn">from</span> <span class="nn">library.reporting</span> <span class="kn">import</span> <span class="n">generate_report</span><span class="p">,</span> <span class="n">export</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/path.csv&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">preprocess</span><span class="p">(</span><span class="n">clean</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">predict_results</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">generate_report</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="n">export</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="packages">
<span id="id2"></span><h3>Packages<a class="headerlink" href="#packages" title="Permalink to this headline">¶</a></h3>
<p>Programming languages often come with quite a few in-built functions and classes that are available to the end-users. However, when it comes to solving specialised problems, these in-built functions are often not enough. In these cases, you may need to build functionality to address a given problem from scratch. If the solutions you build are useful and reusable, you can then wrap them up in a package to allow other users to install it. They can then reuse the work you have put in within their own code to solve similar problems.</p>
<p>In short, packages are self-contained collections of code written by someone else to solve a particular problem. For example, packages like <code class="docutils literal notranslate"><span class="pre">dplyr</span></code> and <code class="docutils literal notranslate"><span class="pre">pandas</span></code> are essential when performing data wrangling in R and Python, respectively. They contain a myriad of functions that allows us to avoid rewriting this functionality from scratch every time. Inside these packages is a set of <a class="reference internal" href="#modules"><span class="std std-ref">modules</span></a> containing relevant functions, classes and other code that someone has written. These are wrapped up into a package structure so that the programming language you use can understand, install and make available to you for import.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section will not cover the practices required to package and distribute your code as a package. However if you would like to know more please look to the <a class="reference internal" href="code_documentation.html"><span class="doc std std-doc">code documentation section</span></a> and seek out the packaging guides for your programming language.</p>
</div>
<p>It is useful to keep in mind the question: is my code solving a problem that someone else has not already solved in my programming language? If the answer is ‘Yes’ then perhaps it is worth considering wrapping up your code and distributing it wider.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Packaging code properly will involve applying many of the recommendations from this book.</p>
<p>You will have to consider how to test, document and lay out your code for it to be usable and packagable. In the end, high quality packages are the cornerstone of open-source package ecosystems. However, it is not trivial to maintain and develop well-regarded open-source packages.</p>
<p>If you feel like you are writing code that you might consider turning into a package, consult this book and strive to apply as many of the recommendations as you go. This will make the final polish and packaging much simpler, and will produce packages that are easier for third-parties to trust and use.</p>
</div>
</div>
</div>
<div class="section" id="notebooks">
<h2>Notebooks<a class="headerlink" href="#notebooks" title="Permalink to this headline">¶</a></h2>
<p>It is worth touching upon using Jupyter or other code Notebooks that allow running of your code.</p>
<p>Although individual notebooks could seem like a good way to modularise your analysis for distribution, for larger projects this is not always the best idea.</p>
<p>notebooks are inherently difficult to review and audit through version control software like <code class="docutils literal notranslate"><span class="pre">git</span></code>. Simple text files like scripts can be version controlled easily as you can see which lines of text change from one version to another. notebooks store their internal workings in a much more complicated format, hence seeing the changes from one notebook to another as differences line by line is not possible in common version control tools.</p>
<p>Furthermore, defining and keeping functions within notebooks is prohibitive to testing. It is not simple to test individual cells of a notebook with standard external tooling.</p>
<p>Lastly, one of the key issues with notebooks when they are used as methods for running a pipeline is the ability to run cells out of order. In practice this means that a user can accidentally execute the steps of the analysis in the wrong order causing issues and different results. As such, notebook results may not always be reproducible.</p>
<p>That said, great strengths of notebooks include their flexibility in displaying results while you are exploring data, and their ability to present final research code alongside a narrative. Therefore the top 2 reasons to use notebooks in the project lifecycle is to:</p>
<ul class="simple">
<li><p>explore and ‘play’ with the data while developing your methods.</p></li>
<li><p>turn notebooks into HTML reports to present results to end users.</p></li>
</ul>
<p>In short, notebooks are not suitable for modularising analysis pipelines, however, they are a great way to do research analytics and to present results. Therefore, as the exploratory part of your analysis draws to a close, or there is a need to produce similar analysis more regularly, it is wise to refactor notebooks. Reusable functions and classes can be moved to modules and the main analysis pipeline might instead be reproducibly run from a script. Here are a few suggestions to consider when refactoring code from notebooks:</p>
<ul class="simple">
<li><p>Review the repetitive cells and assess which of them can be turned into reusable functions.</p></li>
<li><p>Extract existing functions into related groups, as modules.</p></li>
<li><p>Document, test and improve these functions and modules following the guidance laid out in this book.</p></li>
<li><p>Import the required functionality from these new modules into the notebook or pipeline script.</p></li>
<li><p>For new analysis, reuse functionality from these modules in new notebooks and continue to document your analytical thinking alongside your code in these notebooks.</p></li>
</ul>
<p>After this, you might turn existing notebooks into HTML to send them stakeholders, or save them as is so that analytical peers can re-run and review your notebooks. The steps that you’ve taken to simplify your notebook code will make your code much easier to understand by readers.</p>
<p>Bear in mind that notebook files can still be run out of order by other analysts, and that they should not be used as the main method of actually generating outputs. Output generation should instead be trusted to scripts, where human decisions do not alter the order that code is run.</p>
</div>
<div class="section" id="clean-code">
<h2>Clean code<a class="headerlink" href="#clean-code" title="Permalink to this headline">¶</a></h2>
<blockquote class="epigraph">
<div><p>Programs are meant to be read by humans and only incidentally for computers to execute.</p>
<p class="attribution">—Donald Knuth, The Art of Computer Programming</p>
</div></blockquote>
<p>Code with high readability is often referred to as ‘clean code’. Clean code helps us understand a program faster, as it avoids points of confusion and ambiguity.</p>
<p>The following sections will present some key aspects of writing clean code that are fairly widely applicable. That said, each individual programming language has idiomatic ways of writing code that are specific to its features. Additionally, each language usually has some form of accepted style guide.</p>
<p>Make sure to consult the style guides for your language as first point of call. This is an important point to stress, as these guides will capture the most up to date guidance for your language of choice, which may not be available in this document.</p>
<div class="section" id="naming">
<span id="id3"></span><h3>Naming<a class="headerlink" href="#naming" title="Permalink to this headline">¶</a></h3>
<p>The most important aspect of clean code is the naming of identifiers within your code. This includes variables, functions, classes and any other objects that can be assigned a name.</p>
<p>Someone reading your code will benefit greatly if you use names that are:</p>
<ul class="simple">
<li><p>informative and not misleading</p></li>
<li><p>concise but not cryptic</p></li>
</ul>
<div class="section" id="naming-variables">
<span id="id4"></span><h4>Naming variables<a class="headerlink" href="#naming-variables" title="Permalink to this headline">¶</a></h4>
<p>You may have previously come across code that contains variable names that are meaningless, or that imply an incorrect purpose:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Sioban&quot;</span>

<span class="n">y</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">my_favourite_number</span> <span class="o">=</span> <span class="s2">&quot;ssh, I&#39;m a string&quot;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="s">&quot;Sioban&quot;</span>

<span class="n">y</span> <span class="o">&lt;-</span> <span class="m">42</span>

<span class="n">z</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">()</span>

<span class="n">my_favourite_number</span> <span class="o">&lt;-</span> <span class="s">&quot;ssh, I&#39;m a string&quot;</span>
</pre></div>
</div>
</div></div>
<p>Another developer, or even ‘future you’, would be unable to correctly interpret what these variable names to represent. Therefore, you should strive to avoid cryptic or single-letter identifiers.</p>
<p>That said, there are situations where some seemingly cryptic identifiers make sense. Using single letters to name variables is suitable when implementing methodologies from mathematical notation. However, even in these cases you must make sure that the formulas being implemented are clear, readily available to the reader and are consistent throughout  your code. Be sure to cite the source of the mathematical formula in these cases.</p>
<p>In other cases, using variable names that contain a few (3 or so) informative words can drastically improve the readability of your code. How these words are separated (be it <code class="docutils literal notranslate"><span class="pre">CamelCase</span></code> or <code class="docutils literal notranslate"><span class="pre">snake_case</span></code>) will depend on your language of choice.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Defining variables</span>
<span class="n">first_name</span> <span class="o">=</span> <span class="s2">&quot;Sioban&quot;</span>

<span class="n">number_of_attendees</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">empty_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>


<span class="c1"># Using variables</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hi &quot;</span> <span class="o">+</span> <span class="n">first_name</span><span class="p">)</span>

<span class="n">number_of_attendees</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">empty_dataframe</span><span class="o">.</span><span class="n">empty</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining variables</span>
<span class="n">first_name</span> <span class="o">&lt;-</span> <span class="s">&quot;Sioban&quot;</span>

<span class="n">number_of_attendees</span> <span class="o">&lt;-</span> <span class="m">42</span>

<span class="n">empty_dataframe</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">()</span>


<span class="c1"># Using variables</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Hi&quot;</span> <span class="o">+</span> <span class="n">first_name</span><span class="p">))</span>

<span class="n">number_of_attendees</span> <span class="o">&lt;-</span> <span class="n">number_of_attendees</span> <span class="o">+</span> <span class="m">1</span>

<span class="n">plyr</span><span class="o">::</span><span class="nf">empty</span><span class="p">(</span><span class="n">empty_dataframe</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>Ideally, the purpose of variables should be clear from reading their names.
In addition, the variable names should make logical sense in the context that they are used later on in the code. This removes the need for explanatory comments, as your intentions can be interpreted from the code itself (‘self-documenting’ code).</p>
<p>Naming is important for distinguishing between similar variables. A first instinct might be to assign numerical suffixes or other similar tags to differentiate variables. However, unless the suffix itself is meaningful within the context of the rest of the code, it will not make the code more understandable:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-2-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-2-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">letters_1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>
<span class="n">letters_2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">letters_1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">)</span>
<span class="n">letters_2</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="s">&quot;z&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>Here we can infer what these lists and vectors contain, but it is not apparent what makes <code class="docutils literal notranslate"><span class="pre">letters_1</span></code> different to <code class="docutils literal notranslate"><span class="pre">letters_2</span></code>.</p>
<p>Variable names can be used to document differences between variables, or to incrementally describe changes made to a variable.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-3-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-3-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">letters_first_three</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>
<span class="n">letters_last_three</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]</span>

<span class="n">letters_first_three_reversed</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">first_three_letters</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">letters_first_three</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">)</span>
<span class="n">letters_last_three</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="s">&quot;z&quot;</span><span class="p">)</span>

<span class="n">letters_first_three_reversed</span> <span class="o">&lt;-</span> <span class="nf">rev</span><span class="p">(</span><span class="n">first_three_letters</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>Here the naming convention indicates that both lists are similar, but also describes the differences between them.
It is also clear how the third, new list relates to the first list that was used to create it.</p>
<p>With more informative names, we obviously lose the brevity of variable names:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">letters_first_three_reversed_plus_t_minus_a_converted_to_greek</span>
</pre></div>
</div>
<p>There is a clear trade-off between the usability and informativeness of variable names.
You’ll need to use your best judgement to adapt variable names in order to keep them informative but reasonably concise.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In languages like Python, where indentation is part of the syntax to denote code blocks, you will be much more aware of this trade-off.</p>
<p>In practice, the PEP8 style guide for Python recommends line widths of 79 characters and having overly descriptive names might impact your compliance with a style guide like that.</p>
</div>
</div>
<div class="section" id="naming-functions">
<span id="id5"></span><h4>Naming functions<a class="headerlink" href="#naming-functions" title="Permalink to this headline">¶</a></h4>
<p>Naming functions should respect the best practices already covered in the <a class="reference internal" href="#naming-variables"><span class="std std-ref">Naming variables</span></a>, however, there are a few other points worth raising that are exclusive to function and method names.</p>
<p>Firstly, your user should be able to infer the purpose or action of a function from its name. If you can’t describe the overall task performed by the function in a few words, then it may be that your function is overly complex or it requires further detail in its documentation.</p>
<p>Where a function performs a specific task, it can be effective to describe this task in the function name, starting with a verb:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-4-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-4-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-4-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-4-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">process_text</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="o">...</span>

<span class="n">processed_text</span> <span class="o">=</span> <span class="n">process_text</span><span class="p">(</span><span class="s2">&quot;The following document was handled using...&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">process_text</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kc">...</span>
<span class="p">}</span>

<span class="n">processed_text</span> <span class="o">=</span> <span class="nf">process_text</span><span class="p">(</span><span class="s">&quot;The following document was handled using...&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>This is often a tidy way to structure high-level functions in your pipeline. Well defined, verb-based names often lead to clear pipelines such as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="s2">&quot;path/to/data&quot;</span>

<span class="c1"># in short</span>
<span class="n">report_data</span> <span class="o">=</span> <span class="n">generate_report</span><span class="p">(</span> <span class="n">model</span><span class="p">(</span> <span class="n">clean</span><span class="p">(</span> <span class="n">load</span><span class="p">(</span> <span class="n">data_path</span> <span class="p">))))</span>

<span class="c1"># or, more explicitly</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
<span class="n">clean_data</span> <span class="o">=</span> <span class="n">clean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">model_results</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">clean_data</span><span class="p">)</span>
<span class="n">report_data</span> <span class="o">=</span> <span class="n">generate_report</span><span class="p">(</span><span class="n">model_results</span><span class="p">)</span>
</pre></div>
</div>
<p>In cases where a function responds with a Boolean (True or False) value, it is often useful to name this function in the form of a question.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-5-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-5-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-5-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-5-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_clean</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">is_clean</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">){</span>
      <span class="kc">TRUE</span>
  <span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
      <span class="kc">FALSE</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<p>This improves the readability of code that applies these functions.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-6-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-6-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-6-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-6-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">is_clean</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
   <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-6-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">if </span><span class="p">(</span><span class="nf">is_clean</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="p">{</span>
    <span class="nf">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
</div>
<div class="section" id="naming-classes">
<h4>Naming classes<a class="headerlink" href="#naming-classes" title="Permalink to this headline">¶</a></h4>
<p>Class names are usually started with a capital letter, and in <code class="docutils literal notranslate"><span class="pre">CamelCase</span></code>, as this differentiates them from <code class="docutils literal notranslate"><span class="pre">variableNames</span></code> and <code class="docutils literal notranslate"><span class="pre">variable_names</span></code>. Class names follow the same advice as for <a class="reference internal" href="#naming-functions"><span class="std std-ref">Naming functions</span></a> - namely, is it obvious from the class name what it does? If its too complex to name concisely, it is an indication of too many <a class="reference internal" href="#class-responsibilities"><span class="std std-ref">responsibilities</span></a> and you should refactor your code into more, smaller classes.</p>
<p>Method names in a class closely follow the requirements for <a class="reference internal" href="#naming-functions"><span class="std std-ref">Naming functions</span></a>, as methods are just functions that are tied to a class. They should ideally read clearly when called from a class instance - such as <code class="docutils literal notranslate"><span class="pre">bookParser</span> <span class="pre">=</span> <span class="pre">TextParser(book_data)</span></code> followed with <code class="docutils literal notranslate"><span class="pre">bookParser.getNextWord()</span></code>. Compare this against <code class="docutils literal notranslate"><span class="pre">bp</span> <span class="pre">=</span> <span class="pre">Reader(book_data)</span></code> then <code class="docutils literal notranslate"><span class="pre">bp.fetch()</span></code>, where there is not enough context.</p>
</div>
</div>
<div class="section" id="code-style">
<span id="id6"></span><h3>Code style<a class="headerlink" href="#code-style" title="Permalink to this headline">¶</a></h3>
<p>Programming languages can differ in a myriad of ways. One way R and Python differ, for example, is their use of indentation. Indentation is part of the well defined syntax of Python while it is not in the case of R. This does not mean that you shouldn’t use indentation in R to make your code more readable. If in doubt it is often wise to consult how to use formatting to write more readable code by finding the style guidelines for your language.</p>
<p>Generally, code style guides provide a standard or convention for formatting and laying out your code. The purpose of these style guides is to increase consistency across the programming community for a given language.</p>
<p>They might include how to appropriately:</p>
<ul class="simple">
<li><p>comment or document your code</p></li>
<li><p>name your functions, variables or classes</p></li>
<li><p>separate elements of your code with whitespace</p></li>
<li><p>use indentation to make sure your code is readable</p></li>
<li><p>other useful guidance regarding formatting</p></li>
</ul>
<p>The existence of such style guides does not necessarily mean that each individual or team will apply these conventions to the letter. Organisations and developer teams often have needs that might not be addressed in a general style guidance document. After all, these documents aim to capture the needs of a diverse group of developers. Therefore, these guides are more useful as starting points in a discussion on ‘how should our team be consistent internally in the way we write code?’.</p>
<div class="figure align-default" id="code-quality">
<a class="reference internal image-reference" href="_images/code_quality.png"><img alt="Comic strip describing a brutal code review." src="_images/code_quality.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-number">Fig. 2 </span><span class="caption-text">Code Quality, from <a class="reference external" href="https://xkcd.com/1513/">xkcd</a></span><a class="headerlink" href="#code-quality" title="Permalink to this image">¶</a></p>
</div>
<p>The core idea around these guides is that individual teams have to either adopt them or adapt them for use while writing code. The goals are readability and consistency.
This consistency between developers will most likely aid speed of development and review, as well as the ability of one developer to comprehend code written by their colleagues.</p>
<div class="admonition-common-style-guides admonition">
<p class="admonition-title">Common Style Guides</p>
<p><a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP8</a> is an official Python style guide, which is widely used.
The <a class="reference external" href="https://google.github.io/styleguide/Rguide.html">Google</a> and <a class="reference external" href="https://style.tidyverse.org/">tidyverse</a> style guides are commonly used for R.</p>
</div>
<div class="section" id="idiomatic-code">
<h4>Idiomatic code<a class="headerlink" href="#idiomatic-code" title="Permalink to this headline">¶</a></h4>
<p>There is perhaps a misconception that following style guidelines and formatting your code accordingly is the fundamental goal of writing good code in a given language.</p>
<p>In reality, guidelines may encourage code-reviews to focus on style over more fundamental problems with the code. They have the potential to detract from assessment of whether the code is making the best use of a given language.</p>
<p>The notion of style goes beyond simple spacing or capitalisation. In the same way that knowing and using common idioms such as ‘over the moon’ or ‘cold feet’ make you seem like a more fluent speaker of English, a part of being fluent in a programming language is being able to write ‘idiomatic’ code. Idiomatic stands for ‘using, containing, or denoting expressions that are natural to a native speaker’. In Python, idiomatic approaches to writing code are commonly referred to as ‘pythonic’.</p>
<p>This might mean simplifying complex and perhaps hard to read patterns into a simpler, but well established alternative. In Python for example these two pieces of code are equivalent:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 1 - very unpythonic</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">my_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
  <span class="n">my_data</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">i</span> <span class="o">/</span> <span class="mi">356</span><span class="p">]</span>
  <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Example 2 - more use of Python features, such as `range` and `append`</span>
<span class="n">my_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
  <span class="n">my_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">356</span><span class="p">)</span>

<span class="c1"># Example 3 - making full use pythonic idioms, `range` with list comprehension</span>
<span class="n">my_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">356</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
</pre></div>
</div>
<p>The ability to write idiomatic code in a given language comes with time. However, it is important to think about it while looking at a given piece of code: is it using everything that language ‘X’ has to offer?</p>
<p>That said, we should still prefer readability over idioms that might make our code more complex. For example, attempting to fit too much logic into a single line of code can make it considerably harder to understand.</p>
</div>
<div class="section" id="checking-code-style">
<h4>Checking code style<a class="headerlink" href="#checking-code-style" title="Permalink to this headline">¶</a></h4>
<p>It is good practice to follow a style guide from the beginning of a project. However, it can be tedious to check that code continues to follow a particular style, or to fix code formatting when it doesn’t. Hence, automated support can be sought to speed up this work, either by providing suggestions as the code is written or by reformatting your code to comply with some style.</p>
<p>Two main types of tool exist for these tasks:</p>
<ul class="simple">
<li><p>Linters - these analyse your code to flag stylistic errors (and sometimes bugs or security issues too).</p></li>
<li><p>Formatters - these not only detect when you have diverged from a style, but will automatically correct the formatting of your code to conform to a particular style.</p></li>
</ul>
<table class="table" id="linters">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Packages that can be used for linting or formatting in Python and R</span><a class="headerlink" href="#linters" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Language</p></th>
<th class="head"><p>Linters</p></th>
<th class="head"><p>Formatters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Python</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">flake8</span></code>, <code class="docutils literal notranslate"><span class="pre">pylint</span></code>, <code class="docutils literal notranslate"><span class="pre">Bandit</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Black</span></code>, <code class="docutils literal notranslate"><span class="pre">Isort</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>R</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">lintr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">formatR</span></code>, <code class="docutils literal notranslate"><span class="pre">styler</span></code></p></td>
</tr>
</tbody>
</table>
<p>Be sure to read the documentation for any of these tools, to understand what they are checking/changing in your code. Some can be configured to ignore or detect specific types of formatting error. You can run multiple of these, to catch a broader range of stylistic or programmatic errors.</p>
<p>If you’re considering these tools as part of a project, see <a class="reference internal" href="version_control.html#continuous-integration"><span class="std std-ref">Continuous Integration</span></a> for advice on automating them. Alternatively, explore other options, such as <a class="reference external" href="https://pre-commit.com/">pre-commit</a>, that do the formatting and checking on your machine prior to a Git commit.</p>
</div>
</div>
</div>
<div class="section" id="software-ideas-for-analysts">
<span id="id7"></span><h2>Software ideas for analysts<a class="headerlink" href="#software-ideas-for-analysts" title="Permalink to this headline">¶</a></h2>
<p>It’s important to remember that when we write code for analysis, we are developing software. Over many years, software engineering teams have developed good practices for developing robust software. These practices help to make our code simple, readable and easier to maintain. Analysts using code as a means to perform analysis can benefit from at least partially applying such practices in their own codebases.</p>
<p>This chapter will try to condense key messages and guidelines from these practices, for use by analysts who write code. That said, reading and learning more about these practices is likely to benefit the quality of your code and is highly encouraged.</p>
<div class="section" id="keep-it-simple">
<h3>Keep it simple<a class="headerlink" href="#keep-it-simple" title="Permalink to this headline">¶</a></h3>
<p>The ability to convey information in a simple and clear way matters.</p>
<p>This is particularly true when explaining concepts that are already complex. When writing code you are often trying to solve problems that are complex in nature. You should avoid introducing extra complexity to these problem, wherever possible. A good guideline to achieve this is to seek out the simplest solution wherever possible.</p>
<p>More generally here are a few tips to make sure you keep your project nice and simple:</p>
<ul class="simple">
<li><p>Solve the problem - do not get distracted and make sure you have a clear outcome in mind.</p></li>
<li><p>Try not to ‘reinvent the wheel’ - use existing packages when they solve the problem. They will most likely be better documented and won’t need extra maintenance.</p></li>
<li><p>Split your code into understandable parts - consider how to <a class="reference internal" href="#modular"><span class="std std-ref">make your code modular</span></a>.</p></li>
<li><p>Don’t over-engineer your solution - if it is understandable and works, refrain from over-complicating for the sake of small increases in efficiency.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It’s important to capture the requirements of your code before writing it. This includes when your code needs to be adapted to meet changing needs. You should then aim to meet these requirements in the functionality that your code provides.</p>
<p>It can be tempting to try to account for every eventuality in your program, but developing anything more than these requirements may not be beneficial. There’s a good chance that many cases that you account for will never occur, so you should try to prioritise based on what you’re certain is needed from your code.</p>
<blockquote>
<div><p>You ain’t gonna need it</p>
</div></blockquote>
<p>Remember that additional features will require more documentation and testing to ensure that they ae working correctly. Really consider if adding these extras will make your code more or less maintainable, user-friendly and correct.</p>
</div>
<p>Lastly, it is worth stressing that complex problems might require complex solutions. In those cases make sure that you only introduce complexity where it is needed. You should address necessary complexity with proportionate quality assurance - through documentation, testing and review. For instance, if the execution time of your code is critical, then making the code more complex to achieve a faster runtime may be an acceptable trade-off.</p>
</div>
<div class="section" id="don-t-repeat-yourself">
<h3>Don’t Repeat Yourself<a class="headerlink" href="#don-t-repeat-yourself" title="Permalink to this headline">¶</a></h3>
<p>In the section on <a class="reference internal" href="#modular"><span class="std std-ref">modular code</span></a>, you were encouraged to refactor your code into more self-contained components for ease of testing, reproducibility and reusability. However, it is worth stressing that ‘quick and dirty’ solutions often involve copy-pasted code that is functionally identical. This is expected and is natural in the initial stages of a project. Nonetheless, repetition not only wastes your time, but it also makes your code more difficult to read.
3*QA
Consider a script that contains three copies of a similar piece of code. If the code that is used to perform the repetitive task is found to be incorrect, or if a developer wishes to modify the task being performed by this code, they must implement a similar change in each of the three copies. If only two copies were spotted and amended, there is now a bug sleeping in the code waiting to be triggered… Moreover, anyone reviewing the code would need to check that the right logic is being used three times over.</p>
<p>To put this in context, let us use an example where the developer wants to get the odd numbers from three different lists of numbers:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-7-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-7-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-7-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-7-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">first_ten_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">second_ten_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>
<span class="n">third_ten_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">31</span><span class="p">))</span>

<span class="n">odd_first</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">first_ten_numbers</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">odd_first</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>

<span class="n">odd_second</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">second_ten_numbers</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">odd_second</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>

<span class="n">odd_third</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">third_ten_numbers</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">odd_third</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-7-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">first_ten_numbers</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span>
<span class="n">second_ten_numbers</span> <span class="o">=</span> <span class="m">11</span><span class="o">:</span><span class="m">20</span>
<span class="n">third_ten_numbers</span> <span class="o">=</span> <span class="m">21</span><span class="o">:</span><span class="m">30</span>

<span class="n">odd_first</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span>
<span class="nf">for </span><span class="p">(</span><span class="n">number</span> <span class="n">in</span> <span class="n">first_ten_numbers</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">number</span> <span class="o">%%</span> <span class="m">2</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">odd_first</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">odd_first</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>


<span class="n">odd_second</span> <span class="o">=</span> <span class="nf">c</span><span class="p">()</span>
<span class="nf">for </span><span class="p">(</span><span class="n">number</span> <span class="n">in</span> <span class="n">second_ten_numbers</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">number</span> <span class="o">%%</span> <span class="m">2</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">odd_second</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">odd_second</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">odd_third</span> <span class="o">=</span> <span class="nf">c</span><span class="p">()</span>
<span class="nf">for </span><span class="p">(</span><span class="n">number</span> <span class="n">in</span> <span class="n">third_ten_numbers</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">number</span> <span class="o">%%</span> <span class="m">2</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">odd_third</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">odd_third</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<p>In this example, the third repeated snippet of code actually collects even numbers, but incorrectly assigns them to the <code class="docutils literal notranslate"><span class="pre">odd_third</span></code> variable. Because each copy looks very similar, you might assume that all copies of the code are performing the same task. Even when you are aware of the difference between the copies, you might be unable to tell if the difference is intentional or a mistake. The example demonstrates how repetition can add confusion when trying to maintain or review code.</p>
<p>Modifying multiple copies of a code snippet is laborious and presents a risk - some copies of the repeated code may be modified while others erroneously remain the same. This is analogous to modifying the formula in individual cells of a spreadsheet. If you refactor repetitive code into functions or classes, then bug fixes or modifications need only be carried out once to change all uses of that code. New, intended behaviour is then consistently given by each call of the function or method.</p>
<p>The following presents how one could change the previous example for the better:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-8-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-8-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-8-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-8-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_odd</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get only the odd numbers&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">number</span> <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span> <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">first_ten_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">second_ten_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>
<span class="n">third_ten_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>

<span class="n">odd_first</span> <span class="o">=</span> <span class="n">get_odd</span><span class="p">(</span><span class="n">first_ten_numbers</span><span class="p">)</span>
<span class="n">odd_second</span> <span class="o">=</span> <span class="n">get_odd</span><span class="p">(</span><span class="n">second_ten_numbers</span><span class="p">)</span>
<span class="n">odd_third</span> <span class="o">=</span> <span class="n">get_odd</span><span class="p">(</span><span class="n">third_ten_numbers</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-8-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">get_odd</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">odd_numbers</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="nf">for </span><span class="p">(</span><span class="n">number</span> <span class="n">in</span> <span class="n">first_ten_numbers</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">if </span><span class="p">(</span><span class="n">number</span> % <span class="m">2</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nf">odd_first_ten_numbers.append</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">return</span> <span class="n">odd_numbers</span>
<span class="p">}</span>


<span class="n">first_ten_numbers</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span>
<span class="n">second_ten_numbers</span> <span class="o">=</span> <span class="m">11</span><span class="o">:</span><span class="m">20</span>
<span class="n">third_ten_numbers</span> <span class="o">=</span> <span class="m">21</span><span class="o">:</span><span class="m">30</span>

<span class="n">odd_first</span> <span class="o">=</span> <span class="nf">get_odd</span><span class="p">(</span><span class="n">first_ten_numbers</span><span class="p">)</span>
<span class="n">odd_second</span> <span class="o">=</span> <span class="nf">get_odd</span><span class="p">(</span><span class="n">second_ten_numbers</span><span class="p">)</span>
<span class="n">odd_third</span> <span class="o">=</span> <span class="nf">get_odd</span><span class="p">(</span><span class="n">third_ten_numbers</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>If the functionality of <code class="docutils literal notranslate"><span class="pre">get_odd</span></code> needs to be modified, it now need only be done once. Additionally, this code is more concise and its purpose is easier to interpret.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If two slightly different tasks must be carried out, for example you need both the odd and the even numbers, you might approach this in one of two ways:</p>
<ul class="simple">
<li><p>Develop two functions containing the different elements of code, with names that express the difference in their purpose.</p></li>
<li><p>Add a parameter to your function that will allow a user to differentiate between the two tasks.</p></li>
</ul>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-9-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-9-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-9-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-9-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simple and modular</span>
<span class="k">def</span> <span class="nf">is_odd</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if a number is odd.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">get_odd</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get only the odd numbers.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">number</span> <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span> <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">get_even</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get only the even numbers.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">number</span> <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span> <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>


<span class="c1"># More concise, but also more complex - not always best</span>
<span class="k">def</span> <span class="nf">get_numbers_with_parity</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">parity</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get numbers with a given parity (&#39;odd&#39; or &#39;even&#39;).&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">parity</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;odd&quot;</span><span class="p">,</span> <span class="s2">&quot;even&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;parity must be &#39;odd&#39; or &#39;even&#39;&quot;</span><span class="p">)</span>
    <span class="n">remainder</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">parity</span> <span class="o">==</span> <span class="s2">&quot;odd&quot;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">number</span> <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span> <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">remainder</span><span class="p">]</span>

<span class="n">odd_numbers</span> <span class="o">=</span> <span class="n">get_numbers_with_parity</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="s2">&quot;odd&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-9-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simple and modular</span>
<span class="n">is_odd</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">number</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">number</span> <span class="o">%%</span> <span class="m">2</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="kc">TRUE</span>
  <span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
    <span class="kc">FALSE</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">get_odd</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">odd_numbers</span> <span class="o">=</span> <span class="nf">c</span><span class="p">()</span>
  <span class="nf">for </span><span class="p">(</span><span class="n">number</span> <span class="n">in</span> <span class="n">numbers</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">if </span><span class="p">(</span><span class="nf">is_odd</span><span class="p">(</span><span class="n">number</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">odd_numbers</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">odd_numbers</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nf">return</span><span class="p">(</span><span class="n">odd_numbers</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">get_even</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">even_numbers</span> <span class="o">=</span> <span class="nf">c</span><span class="p">()</span>
  <span class="nf">for </span><span class="p">(</span><span class="n">number</span> <span class="n">in</span> <span class="n">numbers</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">is_odd</span><span class="p">(</span><span class="n">number</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">even_numbers</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">even_numbers</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nf">return</span><span class="p">(</span><span class="n">even_numbers</span><span class="p">)</span>
<span class="p">}</span>


<span class="c1"># More concise, but also more complex - not always best</span>
<span class="n">get_numbers_with_parity</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">parity</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">numbers_with_parity</span> <span class="o">=</span> <span class="nf">c</span><span class="p">()</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">parity</span> <span class="o">==</span> <span class="s">&quot;odd&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">remainder</span> <span class="o">=</span> <span class="m">1</span>
  <span class="p">}</span> <span class="n">else</span> <span class="nf">if </span><span class="p">(</span><span class="n">parity</span> <span class="o">==</span> <span class="s">&quot;even&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">remainder</span> <span class="o">=</span> <span class="m">0</span>
  <span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
    <span class="nf">stop</span><span class="p">(</span><span class="s">&quot;parity must be &#39;odd&#39; or &#39;even&#39;&quot;</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">numbers</span><span class="p">[</span><span class="n">numbers</span> <span class="o">%%</span> <span class="m">2</span> <span class="o">==</span> <span class="n">remainder</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">odd_numbers</span> <span class="o">&lt;-</span> <span class="nf">get_numbers_with_parity</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> <span class="s">&quot;odd&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>You should use your best judgement to decide which is most appropriate in a given situation.</p>
</div>
<p>It can be difficult to decide when repetition warrants refactoring of code into reusable functions or classes. The ‘Rule of Three’ suggests that if similar code has been written more than two times, then it is worth extracting its logic to a reproducible procedure like a function or class. However, as you write code you should try to anticipate whether it is likely to be reused in future. If the answer is yes, you might opt to write it straight into something more modular and reusable.</p>
</div>
<div class="section" id="be-explicit">
<h3>Be explicit<a class="headerlink" href="#be-explicit" title="Permalink to this headline">¶</a></h3>
<p>In the literary sense of the word!</p>
<blockquote class="epigraph">
<div><p>Explicit is better than implicit</p>
<p class="attribution">—The Zen of Python (<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">this</span></code>)</p>
</div></blockquote>
<p>In some programming languages, it is possible to perform a task or decision by relying on an implied interpretation of your code.
For example, in Python <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">100</span></code>, <code class="docutils literal notranslate"><span class="pre">[&quot;A</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">text&quot;]</span></code> and many other objects evaluate to <code class="docutils literal notranslate"><span class="pre">True</span></code>, while <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">[]</span></code> and <code class="docutils literal notranslate"><span class="pre">None</span></code> evaluate to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>To make your intentions clear, you should explicitly state your intended comparison in the code.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-10-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-10-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-10-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-10-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">student_count</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Relying on falseness of None</span>
<span class="k">if</span> <span class="n">student_count</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are &quot;</span> <span class="o">+</span> <span class="n">student_count</span> <span class="o">+</span> <span class="s2">&quot; students!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-10-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">student_count</span> <span class="o">&lt;-</span> <span class="kc">FALSE</span>

<span class="c1"># Relying on falseness of FALSE</span>
<span class="nf">if </span><span class="p">(</span><span class="n">student_count</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">print</span><span class="p">(</span><span class="s">&quot;There are &quot;</span> <span class="o">+</span> <span class="n">student_count</span> <span class="o">+</span> <span class="s">&quot; students!&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<p>In the example above, the student count is not printed because <code class="docutils literal notranslate"><span class="pre">None</span></code> and <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> evaluate to false.
In Python and R, 0 will also evaluate to False.
Therefore, it is unclear whether the programmer intended that the statement is printed when the count is 0.
If a count of 0 should be printed, then this lack of specificity has created a bug.</p>
<p>To perform the same decision explicitly, we should specify the exact condition under which the student count should be printed.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-11-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-11-Ug==" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-Ug==" name="Ug==" role="tab" tabindex="-1">R</button></div><div aria-labelledby="tab-11-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-11-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">student_count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Explicitly print only if more than 0</span>
<span class="k">if</span> <span class="n">student_count</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are &quot;</span> <span class="o">+</span> <span class="n">student_count</span> <span class="o">+</span> <span class="s2">&quot; students!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-Ug==" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-11-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">student_count</span> <span class="o">=</span> <span class="m">0</span>

<span class="c1"># Explicitly only print if more than 0</span>
<span class="nf">if </span><span class="p">(</span><span class="n">student_count</span> <span class="o">&gt;=</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">print</span><span class="p">(</span><span class="s">&quot;There are &quot;</span> <span class="o">+</span> <span class="n">student_count</span> <span class="o">+</span> <span class="s">&quot; students!&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<p>Now the count is printed if it is more than or equal to 0.
It’s clear that we intend for this to be the case.</p>
</div>
<div class="section" id="separate-responsibilities">
<h3>Separate responsibilities<a class="headerlink" href="#separate-responsibilities" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>An object should have a single responsibility.
Only changes to one part of the software’s specification should be able to affect the specification of the class.</p>
</div></blockquote>
<p>Th ‘single responsibility’ principle suggests that a single element of your code (a function or class) should be responsible for a single part of your software’s functionality. It should take on one task and perform it well. This is because each piece of code is more robust if there are fewer reasons to change it in the future.</p>
<p>When you work with code that is designed to multitask, it is often difficult to modify this code without having an unintentional effect on other aspects of the software.</p>
<p>Imagine trying to create a model of the economy, which is a complex web of interconnected interactions. Creating ‘abstractions’ in the form of classes or functions that try to model multiple aspects of the economy at once might seem helpful, but when used incorrectly might instead add to the complexity.</p>
<p>For example, consider a class that represents a whole country (<code class="docutils literal notranslate"><span class="pre">Country</span></code>). This would represent a model that is trying to predict economic statistics for a country such as unemployment or inflation. One can imagine that this class will quickly grow into something unmanageable, as its responsibilities grow in the form of additional methods and attributes.</p>
<p>Based on the other chapters in this guidance, you might eventually realise that you need to break this class down further. However, if you had applied the idea of single responsibility, you might have broken the <code class="docutils literal notranslate"><span class="pre">Country</span></code> class down into smaller components such as <code class="docutils literal notranslate"><span class="pre">UnemploymentModel</span></code>, <code class="docutils literal notranslate"><span class="pre">InflationModel</span></code>. These classes would be responsible for doing specific modelling, while the <code class="docutils literal notranslate"><span class="pre">Country</span></code> class might only responsible for presenting the results to, lets say, a higher level economy model that tries to model cross-country trade.</p>
<p>This simplicity also increases usability, by minimising the number of parameters that each function or class might require.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you remember the <a class="reference internal" href="#interfaces"><span class="std std-ref">section on interfaces</span></a>, the different model classes here are a prime example where defining an interface would help you make sure each <code class="docutils literal notranslate"><span class="pre">*Model</span></code> object is interchangeable.</p>
</div>
<p>The ‘separation of concerns’ principle captures a similar concept to single responsibility, but on a higher level. This principle suggests that your software should be separated into distinct sections that each address a single concern.</p>
<p>In the previous economic modelling example, you might establish your concerns to be:</p>
<ul>
<li><p>Model economy at low level: <code class="docutils literal notranslate"><span class="pre">UnemploymentModel</span></code> and <code class="docutils literal notranslate"><span class="pre">InflationModel</span></code>.</p>
<p>These are concerned with the ‘low-level’ details of giving estimates of economic output. They are independent of each other and concerned only by what they are trying to estimate.</p>
</li>
<li><p>Model country level interactions and trade blocks: <code class="docutils literal notranslate"><span class="pre">Country</span></code> and <code class="docutils literal notranslate"><span class="pre">TradeBlock</span></code>.</p>
<p>These parts of your code relate to higher level concepts. They will be using the lower level <code class="docutils literal notranslate"><span class="pre">Model</span></code> classes, but are primarily concerned with interactions between countries.</p>
</li>
<li><p>Run simulations given a description of the desired economy.</p>
<p>Once the model is ready, there might be a ‘SimulationRunner’ that takes in your model of the world economy and runs simulations. In this case, this part of your codebase will only revolve around running the actual simulations.</p>
</li>
</ul>
<p>In each of these distinct sections of your codebase there will be multiple classes and functions, which should follow the single responsibility concepts outlined earlier.</p>
<p>For example, within the section of your code concerned with modelling data, you might have a set of functions to download data from an external data store. These functions should only be responsible for receiving the required data safely and providing it to the <code class="docutils literal notranslate"><span class="pre">Model</span></code> object. If you had the need to download data from different sources online (i.e. Database, CSV or other), you might create several download functions. To pick the right function for each model you might create a <a class="reference external" href="https://en.wikipedia.org/wiki/Factory_(object-oriented_programming)">‘LoaderFactory’</a> who’s only responsibility is to provide the <code class="docutils literal notranslate"><span class="pre">Model</span></code> with the right loading function for the right data source.</p>
<div class="figure align-default" id="separation-of-concerns">
<a class="reference internal image-reference" href="_images/separation_of_concerns.png"><img alt="Representation of concerns and responsibilities within a piece of software." src="_images/separation_of_concerns.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">Representation of concerns and responsibilities within a piece of software</span><a class="headerlink" href="#separation-of-concerns" title="Permalink to this image">¶</a></p>
</div>
<p>As such, separate sections of your software should be responsible for each of the concerns.
Within each section of your software, distinct functions or classes should be responsible for each task that is required for that sections overall functionality.</p>
<div class="admonition-in-the-context-of-functions admonition">
<p class="admonition-title">In the context of functions</p>
<p>The previous example was heavily focused on classes and Object-Oriented Programming. The same principles apply in the world of functions. You define each concern which is addressed by a module containing functions who follow the single responsibility principle.</p>
<p>So the previous example could equally include:</p>
<ul class="simple">
<li><p>An <code class="docutils literal notranslate"><span class="pre">unemployment_model</span></code> - function running the unemployment modelling.</p></li>
<li><p>An <code class="docutils literal notranslate"><span class="pre">inflation_model</span></code> - function running the unemployment modelling.</p></li>
</ul>
<p>These functions would produce data about a given country, to be stored in an object. Another function might then take this data for multiple countries and start modelling it across country boundaries.</p>
<p>The same core concepts still fully apply.</p>
</div>
</div>
<div class="section" id="open-closed">
<h3>Open-closed<a class="headerlink" href="#open-closed" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Objects and functions should be open for extension, but closed for modification.</p>
</div></blockquote>
<p>This means that it should be possible to extend the functionality of classes or functions, without modifying their source code or how they work.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># some function that we want to keep closed for modification</span>
<span class="k">def</span> <span class="nf">core_method</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="c1"># if we want to extend a function without modifying it, we can always do the following</span>
<span class="k">def</span> <span class="nf">extended_methodology</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
     <span class="n">core_results</span> <span class="o">=</span> <span class="n">core_method</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">extended_functionality</span><span class="p">(</span><span class="n">core_results</span><span class="p">)</span>

</pre></div>
</div>
<p>Same would apply with classes through ideas like inheritance.</p>
<p>When you think about the consequences of this, the open-closed principle gives you:</p>
<ol class="simple">
<li><p>Confidence that essential behaviour of parts of your code should not be expected to change.</p></li>
<li><p>The ability to easily add more functionality, as your code evolves.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In functional programming we use higher-order functions and functional composition to enact these principles. ‘Functional composition’ deserves a brief explanation, as a concept that might be keenly used in a data analytics pipeline.</p>
<p>In simple terms, functional composition is a mathematical idea that takes two functions <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> and produces function <span class="math notranslate nohighlight">\(h\)</span>, such that <span class="math notranslate nohighlight">\(h(x) = g(f(x))\)</span>. Analysts familiar with R’s <code class="docutils literal notranslate"><span class="pre">%&gt;%</span></code> operator will find this idea familiar.</p>
<p>Imagine you have a task to perform modelling and report generation from data. You can lay out your code to be easily composable with the following functions, with single responsibilities:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">load</span></code> - loads data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">model</span></code> - runs the model on data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">report</span></code> - runs report generation.</p></li>
</ul>
<p>So when it comes to creating a pipeline you end up with something like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">report</span> <span class="o">=</span> <span class="n">report</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">load</span><span class="p">(</span><span class="n">filepath</span><span class="p">)))</span>
</pre></div>
</div>
<p>We will now assume that these individual functions are closed for modification. However, we can extend the functionality of <code class="docutils literal notranslate"><span class="pre">load</span></code> by adding a <code class="docutils literal notranslate"><span class="pre">clean</span></code> function that cleans the data. In which case, we end up with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can extend this without modifying the source code of `load`</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">report</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">clean</span><span class="p">(</span><span class="n">load</span><span class="p">(</span><span class="n">filepath</span><span class="p">))))</span>


<span class="c1"># or we can first define a new load as follows</span>
<span class="k">def</span> <span class="nf">new_load</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">clean</span><span class="p">(</span><span class="n">load</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>

<span class="n">report</span> <span class="o">=</span> <span class="n">report</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">new_load</span><span class="p">(</span><span class="n">filepath</span><span class="p">)))</span>


<span class="c1"># or with the help of anonymous (lambda)</span>
<span class="n">new_load</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">clean</span><span class="p">(</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">report</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">new_load</span><span class="p">(</span><span class="n">filepath</span><span class="p">)))</span>


<span class="c1"># We can even use this to create a single function to run our defined pipeline</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">report</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">clean</span><span class="p">(</span><span class="n">load</span><span class="p">(</span><span class="n">filepath</span><span class="p">))))</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="principles.html" title="previous page">Principles</a>
    <a class='right-next' id="next-link" href="project_structure.html" title="next page">Structuring your project</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          <div class="extra_footer">
            <p>Best Practice & Impact division, Office for National Statistics</p><p>This document is very young, please help use to make it grow by providing any feedback by <a href='mailto:gsshelp@statistics.gov.uk'>email</a> or via the <a href='https://github.com/best-practice-and-impact/qa-of-code-guidance'>GitHub repository</a>.
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>